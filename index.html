<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="style.css">
    <style type="text/css">
        button,
        div,
        form,
        input {
            margin: 10px;
        }
    </style>
    <title>Giffing Off</title>
</head>

<body>
    <h1>Search</h1>
    <div id="buttons">
        <div id="buttons-view"></div>

    </div>

    <form id="search-form">
        <label for="input">Add a Button</label>
        <input type="text" id="input"><br>

        <!-- Button Triggers a New Movie to be Added -->
        <input id="add" type="submit" value="Add a Button">
    </form>

    <div id="search-view"></div>



    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">

        var searchterms = ["Tobias Funke", "George W. Bush"];
        console.log(searchterms);

       




        function renderButtons() {
            $("#buttons-view").empty();

            for (var i = 0; i < searchterms.length; i++) {
                var a = $("<button>");
                a.addClass("search-btn");
                a.attr("data-name", searchterms[i]);
                a.text(searchterms[i]);
                $("#buttons-view").append(a);
            }
        }

        $("#add").on("click", function (event) {
            event.preventDefault();
            var searchterm = $("#input").val().trim();
            searchterms.push(searchterm);
            console.log(searchterms);
            renderButtons();
        });

        renderButtons();

        //  var displayMovieInfo = function() {
        //     console.log(this);
        //     var giphyRequest=$(this).attr("data-name");

        //     var apikey = "9L1aOPHSKHS3NmjPLZQdDAoFODWDzv0P";
        //     var queryURL = "https://api.giphy.com/v1/gifs/search?api_key=" + apikey + "&q=" + giphyRequest + "&limit=10&offset=0&rating=G&lang=en";


        //     // // Creating an AJAX call for the specific movie button being clicked
        //     $.ajax({
        //         url: queryURL,
        //         method: "GET"
        //     }).then(function (response) {
        //         // var imageUrl = response.data.image_original_url;
        //         console.log(response);

        //         // Creating a div to hold the movie
        //         var giphyDiv = $("<div class='giphyDiv'>");

        //         // Storing the rating data
        //         var rating = response.data.rating;
        //         console.log(rating);

        //         // Creating an element to have the rating displayed
        //         var pOne = $("<p>").text("Rating: " + rating);

        //         // Displaying the rating
        //         giphyDiv.append(pOne);

        //         // Retrieving the URL for the image
        //         var imgURL = response.data.image_original_url;
        //         var giphyimage=$("<img>");
        //         giphyimage.attr("src", imgURL);
        //         giphyimage.attr("alt", "search item")
        //         giphyDiv.append(giphyimage);

        //         // Putting the entire movie above the previous movies
        //         $("#search-view").prepend(giphyDiv);
        //     });
        // }
        
        // $(".search-btn").on("click", function(event) {
        //     var name=$(this).attr("data-name");
        //     displayMovieInfo(name);
        // }); 


            $("#buttons").on ("click", "#buttons-view", function(){
                // (".search-btn").on("click", function(){
            var giphyRequest=$(this).attr("data-name");

            var apikey = "9L1aOPHSKHS3NmjPLZQdDAoFODWDzv0P";
            var queryURL = "https://api.giphy.com/v1/gifs/search?api_key=" + apikey + "&q=" + giphyRequest + "&limit=10&offset=0&rating=G&lang=en";


            // // Creating an AJAX call for the specific movie button being clicked
            $.ajax({
                url: queryURL,
                method: "GET"
            })
            
            .then(function (response) {
                // var imageUrl = response.data.image_original_url;
                console.log(response.data);

                for (i=0; i<response.data.length; i++){
                var giphyDiv = $("<div class='giphyDiv'>");

                var rating = response.data[i].rating;
                console.log(rating);
                var pOne = $("<p>").text("Rating: " + rating);
                giphyDiv.append(pOne);

                var imgURL = response.data[i].images.fixed_height_small.url;
                var giphyimage=$("<img>");
                giphyimage.attr("src", imgURL);
                giphyimage.attr("alt", "search item")
                giphyDiv.append(giphyimage);


                $("#search-view").prepend(giphyDiv);
            };
            });
           
        }) 







    </script>
</body>

</html>